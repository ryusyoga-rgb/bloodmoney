<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Play Blood Money Game Online Free - No download needed! Experience the thrilling human expenditure program featuring Harvey and Eun-mi. Complete challenges, make moral choices, and compete in the ultimate blood money game adventure. Play the full online version now!">
    <meta name="keywords" content="blood money, human expenditure program">
    <meta name="author" content="Blood Money Game">
    <meta property="og:title" content="Blood Money Game Online - No Download Needed | Harvey & Eun-mi Adventure">
    <meta property="og:description" content="Play Blood Money Game online free - No download needed! Experience the ultimate human expenditure program with Harvey and Eun-mi. Navigate moral choices and make life-changing decisions in this thrilling online version adventure.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourwebsite.com">
    <title>Blood Money Game Online - No Download Needed | Harvey & Eun-mi Human Expenditure Program</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        :root {
            --cute-pink: #FFB6C1;
            --cute-purple: #DDA0DD;
            --cute-blue: #87CEEB;
            --cute-yellow: #F0E68C;
            --cute-green: #98FB98;
            --cute-bg: #FFF0F5;
            --card-bg: rgba(255, 255, 255, 0.9);
            --border-color: rgba(255, 182, 193, 0.5);
            --text-dark: #4A4A4A;
            --text-light: #6B6B6B;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(180deg, var(--cute-bg) 0%, #FFE4E1 100%);
            color: var(--text-dark);
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .hero-section {
            background: linear-gradient(rgba(255,255,255,0.9), rgba(255,182,193,0.8)), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 400"><defs><pattern id="hearts" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse"><rect fill="%23FFB6C1" width="40" height="40"/><text fill="%23FF69B4" font-size="20" font-family="Arial" x="20" y="25" text-anchor="middle">♥</text></pattern></defs><rect fill="url(%23hearts)" width="1200" height="400"/><text fill="%23FF1493" font-size="72" font-family="Comic Sans MS" font-weight="bold" x="600" y="200" text-anchor="middle">💕 Blood Money Game 💕</text><text fill="%23937DB" font-size="48" font-family="Comic Sans MS" x="600" y="250" text-anchor="middle">Play with Harvey & Eun-mi!</text></svg>');
            background-size: cover;
            background-position: center;
            padding: 60px 0;
            text-align: center;
            border-bottom: 3px solid var(--cute-pink);
        }

        .game-container {
            background: var(--card-bg);
            border: 2px solid var(--cute-pink);
            border-radius: 20px;
            padding: 0;
            margin: 0;
            box-shadow: 0 0 30px rgba(255, 182, 193, 0.5);
        }

        .game-iframe {
            width: 100%;
            height: 100vh;
            border: none;
            display: block;
        }

        .feature-card {
            background: var(--card-bg);
            border: 3px solid var(--cute-pink);
            border-radius: 25px;
            padding: 30px;
            margin: 20px 0;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(255, 182, 193, 0.3);
        }

        /* Removed hover animation from voting section */

        .btn-custom {
            background: linear-gradient(45deg, var(--cute-pink), var(--cute-purple));
            color: white;
            border: 3px solid var(--cute-blue);
            padding: 15px 35px;
            border-radius: 25px;
            font-weight: bold;
            font-family: 'Comic Sans MS', cursive;
            text-transform: none;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 1.1em;
        }

        .btn-custom:hover {
            background: linear-gradient(45deg, var(--cute-purple), var(--cute-blue));
            border-color: var(--cute-yellow);
            color: white;
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(221, 160, 221, 0.4);
        }

        .leaderboard-table {
            background: rgba(255,255,255,0.8);
            border-radius: 20px;
            overflow: hidden;
            border: 3px solid var(--cute-pink);
        }

        .meme-generator {
            background: rgba(255,255,255,0.9);
            border-radius: 25px;
            padding: 30px;
            margin: 20px 0;
            border: 3px solid var(--cute-purple);
        }

        .meme-canvas {
            border: 3px solid var(--cute-blue);
            border-radius: 15px;
            max-width: 100%;
            background: white;
        }

        .voting-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .ending-btn {
            padding: 20px 40px;
            border: 3px solid white;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Comic Sans MS', cursive;
            font-size: 1.1em;
        }

        .ending-good { background: linear-gradient(45deg, var(--cute-green), var(--cute-blue)); color: white; border-color: var(--cute-green); }
        .ending-normal { background: linear-gradient(45deg, var(--cute-yellow), var(--cute-purple)); color: white; border-color: var(--cute-yellow); }
        .ending-bad { background: linear-gradient(45deg, var(--cute-pink), var(--cute-purple)); color: white; border-color: var(--cute-pink); }

        .social-share {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .social-btn {
            padding: 10px 20px;
            border: 2px solid var(--money-bronze);
            border-radius: 0;
            color: var(--money-gold);
            font-weight: bold;
            text-decoration: none;
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .social-btn:hover {
            transform: translateY(-2px);
            color: white;
        }

        .twitter { background: #1da1f2; }
        .reddit { background: #ff4500; }
        .tiktok { background: #000000; }
        .discord { background: #5865f2; }

        .comment-section {
            background: rgba(255,255,255,0.95);
            border-radius: 25px;
            padding: 30px;
            margin: 20px 0;
            border: 3px solid var(--cute-blue);
            box-shadow: 0 8px 25px rgba(135, 206, 235, 0.3);
        }

        .achievement-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,182,193,0.9);
            z-index: 1000;
        }

        .achievement-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            color: var(--text-dark);
            padding: 40px;
            border-radius: 25px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 3px solid var(--cute-pink);
            box-shadow: 0 8px 30px rgba(255,182,193,0.5);
        }

        .text-edit-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,182,193,0.9);
            z-index: 1001;
        }

        .text-edit-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            color: var(--text-dark);
            padding: 30px;
            border-radius: 25px;
            max-width: 500px;
            width: 90%;
            border: 3px solid var(--cute-purple);
            box-shadow: 0 8px 30px rgba(221,160,221,0.5);
        }

        .achievement-image {
            width: 100%;
            max-width: 400px;
            height: 300px;
            background: linear-gradient(45deg, var(--cute-pink), var(--cute-purple));
            border-radius: 20px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: bold;
            font-family: 'Comic Sans MS', cursive;
            box-shadow: 0 4px 15px rgba(221, 160, 221, 0.3);
        }

        .share-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .share-buttons .btn {
            padding: 10px 20px;
            border-radius: 15px;
            font-family: 'Comic Sans MS', cursive;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .btn-download {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
        }

        .btn-download:hover {
            background: linear-gradient(45deg, #218838, #1ba085);
            transform: translateY(-2px);
        }

        .btn-reddit {
            background: linear-gradient(45deg, #ff4500, #ff6347);
            color: white;
        }

        .btn-reddit:hover {
            background: linear-gradient(45deg, #e03e00, #e74c3c);
            transform: translateY(-2px);
        }

        .btn-tiktok {
            background: linear-gradient(45deg, #000000, #ff0050);
            color: white;
        }

        .btn-tiktok:hover {
            background: linear-gradient(45deg, #1a1a1a, #e60045);
            transform: translateY(-2px);
        }

        .btn-twitter {
            background: linear-gradient(45deg, #1da1f2, #14171a);
            color: white;
        }

        .btn-twitter:hover {
            background: linear-gradient(45deg, #1991db, #0f1419);
            transform: translateY(-2px);
        }

        h1, h2, h3 {
            color: var(--cute-purple);
            font-weight: bold;
            font-family: 'Comic Sans MS', cursive;
            text-transform: none;
            letter-spacing: 1px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .keyword-density {
            color: var(--cute-pink);
            font-weight: bold;
            font-size: 1.1em;
        }

        .image-option .placeholder-img:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .meme-canvas {
            cursor: default;
        }

        .meme-canvas:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .meme-thumbnail {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 15px;
            border: 3px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .meme-thumbnail:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg" style="background: linear-gradient(45deg, var(--cute-pink), var(--cute-purple)); border-bottom: 3px solid var(--cute-blue);">
        <div class="container">
            <div class="d-flex align-items-center justify-content-between w-100">
                <!-- Game Title -->
                <div style="color: white; font-family: 'Comic Sans MS', cursive; font-weight: bold; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                    <div style="font-size: 1.2em;">🎮 Play Blood Money Game Online</div>
                    <div style="font-size: 0.9em; color: var(--cute-yellow);">💕 Free Online Version - No Download Needed!</div>
                </div>
                
                <!-- Navigation Links -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav d-flex flex-row gap-3">
                        <li class="nav-item">
                            <a class="nav-link" href="#harvey-memes" style="color: white; font-family: 'Comic Sans MS', cursive; font-weight: bold;">🎭 Harvey Memes</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#player-leaderboard" style="color: white; font-family: 'Comic Sans MS', cursive; font-weight: bold;">🏆 Leaderboard</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#comment-section" style="color: white; font-family: 'Comic Sans MS', cursive; font-weight: bold;">💬 Discussion</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <!-- Game Section -->
    <section id="game" class="py-0" style="height: 100vh; overflow: hidden;">
        <div class="container-fluid">
            <div class="game-container">
                <div style="position: relative;">
                    <iframe src="https://bloodmoneygame.io/game/bloodmoney/" class="game-iframe" title="Blood Money Game" id="gameFrame"></iframe>
                    <!-- Fullscreen button -->
                    <button onclick="toggleFullscreen()" class="btn btn-custom btn-sm" style="position: absolute; bottom: 20px; right: 120px; z-index: 10; background: rgba(255,255,255,0.9); color: var(--cute-purple); border: 2px solid var(--cute-pink); border-radius: 25px; padding: 8px 15px; font-size: 0.9em;" title="Toggle Fullscreen">
                        🔳 Fullscreen
                    </button>
                    <!-- Share button in bottom right corner -->
                    <div style="position: absolute; bottom: 20px; right: 20px; z-index: 10;">
                        <div class="dropdown">
                            <button class="btn btn-custom btn-sm" type="button" data-bs-toggle="dropdown" style="background: rgba(255,255,255,0.9); color: var(--cute-purple); border: 2px solid var(--cute-pink); border-radius: 25px; padding: 8px 15px; font-size: 0.9em;">
                                🌟 Share
                            </button>
                            <ul class="dropdown-menu" style="background: white; border: 3px solid var(--cute-pink);">
                                <li><a class="dropdown-item" href="#" onclick="shareToTwitter()" style="color: var(--cute-purple);">🐦 Twitter/X</a></li>
                                <li><a class="dropdown-item" href="#" onclick="shareToReddit()" style="color: var(--cute-purple);">👨‍💼 Reddit</a></li>
                                <li><a class="dropdown-item" href="#" onclick="shareToTikTok()" style="color: var(--cute-purple);">🎵 TikTok</a></li>
                                <li><a class="dropdown-item" href="#" onclick="shareToDiscord()" style="color: var(--cute-purple);">💎 Discord</a></li>
                                <li><hr class="dropdown-divider" style="border-color: var(--cute-pink);"></li>
                                <li><a class="dropdown-item" href="#" onclick="copyLink()" style="color: var(--cute-purple);">📋 Copy Link</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Ending Voting Section -->
    <section class="py-3" style="background: var(--cute-bg); border-top: 3px solid var(--cute-pink);">
        <div class="container">
            <div class="feature-card text-center">
                <h3>🌟 Which Ending Did You Get? Vote Now! 🌟</h3>
                <p class="mb-4" style="color: var(--cute-purple); font-size: 1.2rem;">🎯 Complete the blood money game above, then vote for your ending!</p>
                <div class="voting-buttons">
                    <button class="ending-btn ending-good" onclick="voteEnding('good')">
                        😊 Good Ending
                    </button>
                    <button class="ending-btn ending-normal" onclick="voteEnding('normal')">
                        😐 Normal Ending
                    </button>
                    <button class="ending-btn ending-bad" onclick="voteEnding('bad')">
                        😢 Bad Ending
                    </button>
                </div>
                <div class="mt-4">
                    <h4>Current Results:</h4>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="progress" style="height: 30px; border-radius: 15px;">
                                <div id="goodProgress" class="progress-bar" style="background: linear-gradient(45deg, var(--cute-green), var(--cute-blue)); width: 0%; border-radius: 15px;"></div>
                            </div>
                            <small style="color: var(--cute-green); font-weight: bold;">😊 Good Ending</small>
                        </div>
                        <div class="col-md-4">
                            <div class="progress" style="height: 30px; border-radius: 15px;">
                                <div id="normalProgress" class="progress-bar" style="background: linear-gradient(45deg, var(--cute-yellow), var(--cute-purple)); width: 0%; border-radius: 15px;"></div>
                            </div>
                            <small style="color: var(--cute-yellow); font-weight: bold;">😐 Normal Ending</small>
                        </div>
                        <div class="col-md-4">
                            <div class="progress" style="height: 30px; border-radius: 15px;">
                                <div id="badProgress" class="progress-bar" style="background: linear-gradient(45deg, var(--cute-pink), var(--cute-purple)); width: 0%; border-radius: 15px;"></div>
                            </div>
                            <small style="color: var(--cute-pink); font-weight: bold;">😢 Bad Ending</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Harvey Meme Generator -->
    <section id="harvey-memes" class="py-3" style="background: var(--cute-bg); border-top: 3px solid var(--cute-pink); margin-top: 20px;">
        <div class="container">
            <div class="meme-generator">
                <h3>🎭 Harvey Meme Generator 🎭</h3>
                <p>Create your own Harvey memes from the blood money game!</p>
                
                <!-- Image Selection -->
                <div class="mb-4">
                    <h5>📸 Choose Your Image:</h5>
                    <div class="row">
                        <div class="col-md-4 col-6 mb-3">
                            <div class="image-option" onclick="selectMemeImage('harvey1')" id="img-harvey1">
                                <img src="image/harvey1.png" alt="Harvey 1" class="meme-thumbnail" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="placeholder-img" style="background: linear-gradient(45deg, var(--cute-pink), var(--cute-purple)); height: 120px; border-radius: 15px; display: none; align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer; border: 3px solid transparent;">
                                    🤗 Harvey 1
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-6 mb-3">
                            <div class="image-option" onclick="selectMemeImage('harvey2')" id="img-harvey2">
                                <img src="image/harvey2.png" alt="Harvey 2" class="meme-thumbnail" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="placeholder-img" style="background: linear-gradient(45deg, var(--cute-blue), var(--cute-green)); height: 120px; border-radius: 15px; display: none; align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer; border: 3px solid transparent;">
                                    😎 Harvey 2
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-6 mb-3">
                            <div class="image-option" onclick="selectMemeImage('harvey3')" id="img-harvey3">
                                <img src="image/harvey3.png" alt="Harvey 3" class="meme-thumbnail" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="placeholder-img" style="background: linear-gradient(45deg, var(--cute-yellow), var(--cute-purple)); height: 120px; border-radius: 15px; display: none; align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer; border: 3px solid transparent;">
                                    🥳 Harvey 3
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-6 mb-3">
                            <div class="image-option" onclick="selectMemeImage('harvey4')" id="img-harvey4">
                                <img src="image/harvey4.png" alt="Harvey 4" class="meme-thumbnail" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="placeholder-img" style="background: linear-gradient(45deg, var(--cute-green), var(--cute-blue)); height: 120px; border-radius: 15px; display: none; align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer; border: 3px solid transparent;">
                                    🎭 Harvey 4
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-6 mb-3">
                            <div class="image-option" onclick="selectMemeImage('harvey5')" id="img-harvey5">
                                <img src="image/harvey5.png" alt="Harvey 5" class="meme-thumbnail" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="placeholder-img" style="background: linear-gradient(45deg, var(--cute-purple), var(--cute-pink)); height: 120px; border-radius: 15px; display: none; align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer; border: 3px solid transparent;">
                                    🌟 Harvey 5
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-6 mb-3">
                            <div class="image-option" onclick="selectMemeImage('harvey6')" id="img-harvey6">
                                <img src="image/harvey6.png" alt="Harvey 6" class="meme-thumbnail" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="placeholder-img" style="background: linear-gradient(45deg, var(--cute-blue), var(--cute-yellow)); height: 120px; border-radius: 15px; display: none; align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer; border: 3px solid transparent;">
                                    🎨 Harvey 6
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div style="position: relative;">
                            <canvas id="memeCanvas" class="meme-canvas" width="400" height="400"></canvas>
                            <!-- Draggable text elements will be added here -->
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="memeText" class="form-label">📝 Your Text:</label>
                            <textarea class="form-control" id="memeText" placeholder="Enter your meme text" rows="3" style="resize: vertical;" oninput="handleTextInput()"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="textSize" class="form-label">📏 Text Size: <span id="sizeValue">24</span>px</label>
                            <input type="range" class="form-range" id="textSize" min="12" max="48" value="24" oninput="updateMemeText()">
                        </div>
                        <div class="mb-3">
                            <label for="textColor" class="form-label">🎨 Text Color:</label>
                            <input type="color" class="form-control form-control-color" id="textColor" value="#ffffff" oninput="updateMemeText()">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">🖼️ Background Color:</label>
                            <div class="btn-group" role="group">
                                <input type="radio" class="btn-check" name="bgColor" id="bgNone" value="none" checked onchange="updateMemeText()">
                                <label class="btn btn-outline-secondary" for="bgNone">🌈 None</label>
                                
                                <input type="radio" class="btn-check" name="bgColor" id="bgWhite" value="white" onchange="updateMemeText()">
                                <label class="btn btn-outline-light" for="bgWhite">⚪ White</label>
                                
                                <input type="radio" class="btn-check" name="bgColor" id="bgBlack" value="black" onchange="updateMemeText()">
                                <label class="btn btn-outline-dark" for="bgBlack">⚫ Black</label>
                            </div>
                        </div>
                        <button class="btn btn-custom me-2" onclick="addText()">➕ Add Text</button>
                        <button class="btn btn-outline-secondary me-2" onclick="clearCanvas()">🗑️ Clear Text</button>
                        <button class="btn btn-custom" onclick="downloadMeme()">💾 Download PNG</button>
                        
                        <div class="mt-3">
                            <small class="text-muted">💡 Tip: Click text to select, drag to move. Real-time preview while typing!</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Achievement Image Generator -->
    <section class="py-3">
        <div class="container">
            <div class="feature-card">
                <h3>🏆 Achievement Share Generator 🏆</h3>
                <p>Enter your game stats to generate your personalized achievement!</p>
                
                <!-- User Input Form -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="mb-3">
                            <label for="playerName" class="form-label">👤 Player Name:</label>
                            <input type="text" class="form-control" id="playerName" maxlength="20" placeholder="Enter your name" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="gameTime" class="form-label">⏱️ Completion Time (minutes):</label>
                            <input type="number" class="form-control" id="gameTime" min="1" max="999" value="15" placeholder="Enter your completion time">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="gameMoney" class="form-label">💰 Money Earned ($):</label>
                            <input type="number" class="form-control" id="gameMoney" min="0" max="999999" value="45000" placeholder="Enter money earned">
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-12">
                        <div class="mb-3">
                            <label for="moralChoice" class="form-label">🎯 Moral Choice:</label>
                            <select class="form-select" id="moralChoice">
                                <option value="Moral">😊 Moral</option>
                                <option value="Neutral">😐 Neutral</option>
                                <option value="Ruthless">😢 Ruthless</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="text-center">
                    <button class="btn btn-custom" onclick="generateAchievement()">
                        🌟 Generate My Achievement! 🌟
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Player Leaderboard -->
    <section id="player-leaderboard" class="py-3">
        <div class="container">
            <div class="feature-card">
                <h3>🏆 Blood Money Game Leaderboard 🏆</h3>
                <p>Compete for the fastest completion times in the blood money game!</p>
                <div class="leaderboard-table">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Player</th>
                                <th>Time</th>
                                <th>Money</th>
                                <th>Ending</th>
                            </tr>
                        </thead>
                        <tbody id="leaderboard-body">
                            <tr>
                                <td>🥇</td>
                                <td>ProGamer123</td>
                                <td>12:34</td>
                                <td>$50,000</td>
                                <td><span class="badge" style="background: linear-gradient(45deg, var(--cute-green), var(--cute-blue));">😊 Good</span></td>
                            </tr>
                            <tr>
                                <td>🥈</td>
                                <td>SpeedRunner</td>
                                <td>15:22</td>
                                <td>$45,000</td>
                                <td><span class="badge" style="background: linear-gradient(45deg, var(--cute-yellow), var(--cute-purple));">😐 Normal</span></td>
                            </tr>
                            <tr>
                                <td>🥉</td>
                                <td>MoralChoice</td>
                                <td>18:45</td>
                                <td>$38,000</td>
                                <td><span class="badge" style="background: linear-gradient(45deg, var(--cute-pink), var(--cute-purple));">😢 Bad</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

  
    <!-- Comment Section -->
    <section id="comment-section" class="py-3">
        <div class="container">
            <div class="comment-section">
                <h3>💬 Blood Money Game Discussion 💬</h3>
                <p>Share your thoughts, strategies, and experiences with the community!</p>
                
                <div class="mb-4">
                    <h4>Leave a Comment</h4>
                    <div class="mb-3">
                        <input type="text" class="form-control" placeholder="Your Name" id="commentName">
                    </div>
                    <div class="mb-3">
                        <textarea class="form-control" rows="3" placeholder="Share your blood money game experience..." id="commentText"></textarea>
                    </div>
                    <button class="btn btn-custom" onclick="postComment()">📝 Post Comment</button>
                </div>

                <div id="comments-section">
                    <h4>Recent Comments</h4>
                    <div class="border-bottom pb-3 mb-3">
                        <div class="d-flex justify-content-between">
                            <strong>GameMaster2024</strong>
                            <small class="text-muted">2 hours ago</small>
                        </div>
                        <p>This blood money game is amazing! The moral choices really make you think.</p>
                    </div>
                    <div class="border-bottom pb-3 mb-3">
                        <div class="d-flex justify-content-between">
                            <strong>StrategyQueen</strong>
                            <small class="text-muted">5 hours ago</small>
                        </div>
                        <p>Harvey's storyline in the human expenditure program is so compelling. Great game design!</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SEO Article Section -->
    <section class="py-3">
        <div class="container">
            <div class="feature-card">
                <h2>🤔 What is Blood Money Game? Complete Guide to the Human Expenditure Program 🤔</h2>
                
                <h3>💕 Understanding the Blood Money Game Experience 💕</h3>
                <p>Welcome to a unique narrative-driven adventure where moral choices and strategic decisions shape your story. In Blood Money Game, every decision matters as you navigate challenging scenarios where financial and ethical interests collide.</p>
                
                <h3>Core Gameplay Mechanics</h3>
                <p>Meet Harvey and Eun-mi, key characters whose perspectives influence your journey. Your choices impact character development and story outcomes through an interactive narrative system. The game features strategic resource management, relationship building, and meaningful moral considerations that create a thought-provoking experience.</p>

                <h3>How to Play Effectively</h3>
                <p>Success requires careful decision-making, understanding character motivations, and considering long-term consequences. Save frequently to explore different outcomes and pay attention to dialogue clues. The multiple endings system encourages replayability, allowing you to discover how various choices lead to different results.</p>

                <p>Perfect for both newcomers and experienced players, Blood Money Game offers a compelling adventure that challenges you to think critically about your decisions while navigating an engaging storyline with strategic depth.</p>
            </div>
        </div>
    </section>

    <!-- Text Edit Modal -->
    <div id="textEditModal" class="text-edit-modal">
        <div class="text-edit-content">
            <h3>✏️ Edit Text</h3>
            <div class="mb-3">
                <label for="editText" class="form-label">📝 Text:</label>
                <textarea class="form-control" id="editText" rows="3" style="resize: vertical;"></textarea>
            </div>
            <div class="mb-3">
                <label for="editSize" class="form-label">📏 Size: <span id="editSizeValue">24</span>px</label>
                <input type="range" class="form-range" id="editSize" min="12" max="48" value="24" oninput="updateEditText()">
            </div>
            <div class="mb-3">
                <label for="editColor" class="form-label">🎨 Color:</label>
                <input type="color" class="form-control form-control-color" id="editColor" value="#ffffff" oninput="updateEditText()">
            </div>
            <div>
                <button class="btn btn-custom me-2" onclick="saveEditText()">💾 Save</button>
                <button class="btn btn-outline-secondary" onclick="deleteEditText()">🗑️ Delete</button>
                <button class="btn btn-outline-secondary" onclick="cancelEditText()">❌ Cancel</button>
            </div>
        </div>
    </div>

    <!-- Achievement Modal -->
    <div id="achievementModal" class="achievement-modal">
        <div class="achievement-content">
            <h3>🎉 Achievement Unlocked! 🎉</h3>
            <div class="achievement-image" id="achievementImage">
                <div>
                    <div id="achievementEmoji" style="font-size: 60px;">🏆</div>
                    <div id="achievementText">Blood Money Master</div>
                    <div id="achievementStats">Time: 15:30 | Money: $45,000 | Choice: Moral</div>
                </div>
            </div>
            <div class="mb-3">
                <div class="share-buttons">
                    <button class="btn btn-download" onclick="downloadAchievement()" title="Download Achievement Image">
                        📥 Download
                    </button>
                    <button class="btn btn-reddit" onclick="shareToReddit()" title="Share to Reddit">
                        📱 Reddit
                    </button>
                    <button class="btn btn-tiktok" onclick="shareToTikTok()" title="Share to TikTok">
                        🎵 TikTok
                    </button>
                    <button class="btn btn-twitter" onclick="shareToTwitter()" title="Share to X (Twitter)">
                        🐦 X
                    </button>
                    <button class="btn btn-outline-secondary" onclick="closeAchievement()" style="background: var(--cute-blue); color: white; border: 2px solid var(--cute-purple); border-radius: 20px; padding: 12px 25px; font-family: 'Comic Sans MS', cursive;">✨ Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden canvas for image generation -->
    <canvas id="achievementCanvas" style="display: none;"></canvas>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Fullscreen functionality
        function toggleFullscreen() {
            const gameFrame = document.getElementById('gameFrame');
            if (!document.fullscreenElement) {
                gameFrame.requestFullscreen().catch(err => {
                    console.log('Error attempting to enable fullscreen:', err);
                });
            } else {
                document.exitFullscreen();
            }
        }

        // Leaderboard Management
        let leaderboardData = JSON.parse(localStorage.getItem('bloodMoneyLeaderboard')) || [
            { name: 'ProGamer123', time: 12, money: 50000, choice: 'Good', seconds: 34 },
            { name: 'SpeedRunner', time: 15, money: 45000, choice: 'Normal', seconds: 22 },
            { name: 'MoralChoice', time: 18, money: 38000, choice: 'Bad', seconds: 45 }
        ];

        function updateLeaderboard() {
            // Sort by money (descending)
            leaderboardData.sort((a, b) => b.money - a.money);
            
            // Update display
            const tbody = document.getElementById('leaderboard-body');
            tbody.innerHTML = '';
            
            leaderboardData.slice(0, 10).forEach((entry, index) => {
                const row = document.createElement('tr');
                const medal = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : (index + 1) + '.';
                
                const badgeColors = {
                    'Good': 'linear-gradient(45deg, var(--cute-green), var(--cute-blue))',
                    'Normal': 'linear-gradient(45deg, var(--cute-yellow), var(--cute-purple))',
                    'Bad': 'linear-gradient(45deg, var(--cute-pink), var(--cute-purple))'
                };
                
                row.innerHTML = `
                    <td>${medal}</td>
                    <td>${entry.name}</td>
                    <td>${entry.time}:${entry.seconds.toString().padStart(2, '0')}</td>
                    <td>$${entry.money.toLocaleString()}</td>
                    <td><span class="badge" style="background: ${badgeColors[entry.choice]};">${getChoiceEmoji(entry.choice)} ${entry.choice}</span></td>
                `;
                tbody.appendChild(row);
            });
            
            // Save to localStorage
            localStorage.setItem('bloodMoneyLeaderboard', JSON.stringify(leaderboardData));
        }

        function getChoiceEmoji(choice) {
            const emojis = { 'Good': '😊', 'Normal': '😐', 'Bad': '😢' };
            return emojis[choice] || '😐';
        }

        function addToLeaderboard(name, time, money, choice) {
            const seconds = Math.floor(Math.random() * 60);
            leaderboardData.push({
                name: name,
                time: time,
                money: money,
                choice: choice,
                seconds: seconds
            });
            updateLeaderboard();
        }

        // Achievement Generator
        function generateAchievement() {
            // Get user input
            const playerName = document.getElementById('playerName').value.trim();
            const gameTime = parseInt(document.getElementById('gameTime').value) || 15;
            const gameMoney = parseInt(document.getElementById('gameMoney').value) || 45000;
            const moralChoice = document.getElementById('moralChoice').value;
            
            // Validate player name
            if (!playerName) {
                alert('💕 Please enter your name to generate achievement! 💕');
                return;
            }
            
            // Calculate achievement level based on performance
            const achievement = calculateAchievementLevel(gameTime, gameMoney);
            
            // Generate random seconds for display
            const seconds = Math.floor(Math.random() * 60);
            const timeString = `${gameTime}:${seconds.toString().padStart(2, '0')}`;
            
            // Update modal content
            document.getElementById('achievementText').textContent = achievement.name;
            document.getElementById('achievementStats').textContent = `⏱️ Time: ${timeString} | 💰 Money: $${gameMoney.toLocaleString()} | 🎯 Choice: ${moralChoice}`;
            document.getElementById('achievementEmoji').textContent = achievement.emoji;
            document.getElementById('achievementImage').style.background = achievement.color;
            
            // Add to leaderboard (map moral choice values)
            const choiceMapping = {
                'Moral': 'Good',
                'Neutral': 'Normal', 
                'Ruthless': 'Bad'
            };
            addToLeaderboard(playerName, gameTime, gameMoney, choiceMapping[moralChoice]);
            
            // Show modal
            document.getElementById('achievementModal').style.display = 'block';
            
            // Add confetti effect for first time
            if (firstAchievementGeneration) {
                createConfetti();
                firstAchievementGeneration = false;
            }
        }

        function calculateAchievementLevel(time, money) {
            // Calculate performance score (0-100)
            // Time score (faster is better, max 50 points)
            const timeScore = Math.max(0, 50 - (time - 10) * 2);
            
            // Money score (more is better, max 50 points)
            const moneyScore = Math.min(50, (money / 1000) * 5);
            
            // Total score
            const totalScore = timeScore + moneyScore;
            
            // Determine achievement level
            if (totalScore >= 80) {
                return {
                    name: "💎 Blood Money Legend 💎",
                    emoji: "👑",
                    color: "linear-gradient(45deg, #FFD700, #FFA500)",
                    level: "LEGENDARY"
                };
            } else if (totalScore >= 65) {
                return {
                    name: "🏆 Ultimate Champion 🏆",
                    emoji: "🏆",
                    color: "linear-gradient(45deg, #FF69B4, #FF1493)",
                    level: "MASTER"
                };
            } else if (totalScore >= 50) {
                return {
                    name: "⚡ Speed Runner Elite ⚡",
                    emoji: "⚡",
                    color: "linear-gradient(45deg, var(--cute-purple), var(--cute-blue))",
                    level: "ADVANCED"
                };
            } else if (totalScore >= 35) {
                return {
                    name: "🌟 Strategic Master 🌟",
                    emoji: "🎯",
                    color: "linear-gradient(45deg, var(--cute-green), var(--cute-blue))",
                    level: "SKILLED"
                };
            } else {
                return {
                    name: "💰 Novice Explorer 💰",
                    emoji: "🎮",
                    color: "linear-gradient(45deg, var(--cute-yellow), var(--cute-green))",
                    level: "BEGINNER"
                };
            }
        }

    
        function closeAchievement() {
            document.getElementById('achievementModal').style.display = 'none';
        }

        // Achievement Image Generation and Sharing Functions
        function generateAchievementImage() {
            return new Promise((resolve, reject) => {
                const canvas = document.getElementById('achievementCanvas');
                const ctx = canvas.getContext('2d');
                
                // Set canvas size
                canvas.width = 600;
                canvas.height = 400;
                
                // Get achievement data
                const emoji = document.getElementById('achievementEmoji').textContent;
                const text = document.getElementById('achievementText').textContent;
                const stats = document.getElementById('achievementStats').textContent;
                const achievementDiv = document.getElementById('achievementImage');
                const backgroundImage = window.getComputedStyle(achievementDiv).background;
                
                // Create gradient background
                const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                gradient.addColorStop(0, '#ff69b4');
                gradient.addColorStop(1, '#9370db');
                
                // Fill background
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Add border
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 8;
                ctx.strokeRect(4, 4, canvas.width - 8, canvas.height - 8);
                
                // Add shadow
                ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
                ctx.shadowBlur = 20;
                ctx.shadowOffsetX = 5;
                ctx.shadowOffsetY = 5;
                
                // Draw emoji
                ctx.font = '80px Arial';
                ctx.textAlign = 'center';
                ctx.fillStyle = '#ffffff';
                ctx.fillText(emoji, canvas.width / 2, 120);
                
                // Draw title
                ctx.font = 'bold 36px Comic Sans MS';
                ctx.fillStyle = '#ffffff';
                ctx.fillText(text, canvas.width / 2, 200);
                
                // Draw stats
                ctx.font = 'bold 24px Comic Sans MS';
                ctx.fillStyle = '#ffffff';
                const words = stats.split(' | ');
                words.forEach((word, index) => {
                    ctx.fillText(word, canvas.width / 2, 250 + (index * 30));
                });
                
                // Add game branding
                ctx.font = 'bold 20px Comic Sans MS';
                ctx.fillStyle = '#ffffff';
                ctx.fillText('Blood Money Game', canvas.width / 2, 360);
                
                canvas.toBlob((blob) => {
                    resolve(blob);
                }, 'image/png');
            });
        }

        function downloadAchievement() {
            generateAchievementImage().then(blob => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `blood-money-achievement-${Date.now()}.png`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('🎉 Achievement image downloaded successfully! 🎉');
            }).catch(error => {
                console.error('Error generating image:', error);
                alert('💕 Sorry, there was an error downloading the image. Please try again! 💕');
            });
        }

        function shareToReddit() {
            const text = document.getElementById('achievementText').textContent;
            const stats = document.getElementById('achievementStats').textContent;
            const shareText = `Just unlocked "${text}" in Blood Money Game! 🎮\n\n${stats}\n\nCan you beat my score?`;
            const shareUrl = `https://www.reddit.com/submit?title=${encodeURIComponent(shareText)}&url=${encodeURIComponent(window.location.href)}`;
            window.open(shareUrl, '_blank', 'width=600,height=400');
        }

        function shareToTikTok() {
            const text = document.getElementById('achievementText').textContent;
            const stats = document.getElementById('achievementStats').textContent;
            const shareText = `Just unlocked "${text}" in Blood Money Game! 💰\n${stats}\n\n#BloodMoneyGame #GamingAchievement`;
            
            // For TikTok, we'll copy text to clipboard and open TikTok
            navigator.clipboard.writeText(shareText).then(() => {
                alert('📱 Achievement text copied to clipboard! 📱\n\nOpen TikTok and paste to share your achievement!');
                window.open('https://www.tiktok.com/', '_blank');
            }).catch(() => {
                // Fallback: open TikTok directly
                window.open('https://www.tiktok.com/', '_blank');
            });
        }

        function shareToTwitter() {
            const text = document.getElementById('achievementText').textContent;
            const stats = document.getElementById('achievementStats').textContent;
            const shareText = `Just unlocked "${text}" in Blood Money Game! 🏆\n${stats}\n\nCan you beat my score? #BloodMoneyGame #Gaming`;
            const shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(window.location.href)}`;
            window.open(shareUrl, '_blank', 'width=600,height=400');
        }

        // Advanced Meme Generator with Image Selection and Draggable Text
        let selectedImage = 'harvey1';
        let canvas, ctx;
        let textElements = [];
        let isDragging = false;
        let dragElement = null;
        let dragOffset = { x: 0, y: 0 };
        let loadedImages = {};
        let selectedTextIndex = -1; // 当前选中的文字索引
        let isPreviewMode = true; // 实时预览模式
        
        // Voting data
        let voteData = {
            good: 0,
            normal: 0,
            bad: 0
        };
        let hasVoted = false; // Track if user has voted
        let showResults = false; // Control visibility of results
        
        // Achievement data
        let firstAchievementGeneration = true; // Track first time for confetti effect

        // Initialize canvas
        window.addEventListener('load', function() {
            canvas = document.getElementById('memeCanvas');
            ctx = canvas.getContext('2d');
            preloadImages();
            setTimeout(() => {
                selectMemeImage('harvey1');
            }, 1000);
            
            // Add event listeners for drag and drop
            canvas.addEventListener('mousedown', startDrag);
            canvas.addEventListener('mousemove', drag);
            canvas.addEventListener('mouseup', endDrag);
            canvas.addEventListener('mouseleave', endDrag);
            
            // Initialize voting display
            updateVotingResults();
        });

        function preloadImages() {
            const imageNames = ['harvey1', 'harvey2', 'harvey3', 'harvey4', 'harvey5', 'harvey6'];
            console.log('Preloading images...');
            imageNames.forEach(name => {
                const img = new Image();
                img.onload = function() {
                    loadedImages[name] = img;
                    console.log(`Successfully loaded: ${name}`);
                };
                img.onerror = function() {
                    console.log(`Image ${name} not found, using placeholder`);
                };
                img.src = `image/${name}.png`;
            });
        }

        function selectMemeImage(imageId) {
            selectedImage = imageId;
            console.log(`Selected image: ${imageId}`);
            
            // Update UI to show selected image
            document.querySelectorAll('.image-option img, .image-option .placeholder-img').forEach(element => {
                element.style.border = '3px solid transparent';
                element.style.boxShadow = 'none';
            });
            
            const selectedElement = document.querySelector(`#img-${imageId} img, #img-${imageId} .placeholder-img`);
            if (selectedElement) {
                selectedElement.style.border = '3px solid var(--cute-purple)';
                selectedElement.style.boxShadow = '0 4px 15px rgba(221, 160, 221, 0.5)';
            }
            
            // Force redraw after a short delay to ensure images are loaded
            setTimeout(() => {
                drawMemeBackground();
            }, 100);
        }

        function drawMemeBackground() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            console.log(`Drawing background for: ${selectedImage}`);
            console.log(`Available images:`, Object.keys(loadedImages));
            
            // Try to get selected background, fall back to 'none' if not available
            let selectedBg = 'none';
            try {
                const bgRadio = document.querySelector('input[name="bgColor"]:checked');
                if (bgRadio) {
                    selectedBg = bgRadio.value;
                }
            } catch (e) {
                selectedBg = 'none';
            }
            
            // Draw background if selected
            if (selectedBg === 'black') {
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            } else if (selectedBg === 'white') {
                ctx.fillStyle = '#FFFFFF';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }
            
            // Draw the selected image if loaded
            if (loadedImages && loadedImages[selectedImage]) {
                try {
                    const img = loadedImages[selectedImage];
                    const scale = Math.min(canvas.width / img.width, canvas.height / img.height);
                    const x = (canvas.width - img.width * scale) / 2;
                    const y = (canvas.height - img.height * scale) / 2;
                    
                    // Draw image on top of background
                    ctx.drawImage(img, x, y, img.width * scale, img.height * scale);
                    console.log(`Successfully drew image: ${selectedImage}`);
                } catch (e) {
                    console.log(`Error drawing image ${selectedImage}:`, e);
                    // If image drawing fails, show placeholder
                    drawPlaceholder(selectedBg);
                }
            } else {
                console.log(`Image ${selectedImage} not loaded, using placeholder`);
                // Show placeholder if no image loaded
                drawPlaceholder(selectedBg);
            }
            
            // Draw all text elements
            if (textElements && textElements.length > 0) {
                textElements.forEach((element, index) => {
                    drawTextElement(element, index === selectedTextIndex);
                });
            }
        }
        
        function drawPlaceholder(selectedBg) {
            // Draw gradient placeholder
            const gradients = {
                'harvey1': ['#FFB6C1', '#DDA0DD'],
                'harvey2': ['#87CEEB', '#98FB98'],
                'harvey3': ['#F0E68C', '#DDA0DD'],
                'harvey4': ['#98FB98', '#87CEEB'],
                'harvey5': ['#DDA0DD', '#FFB6C1'],
                'harvey6': ['#87CEEB', '#F0E68C']
            };
            
            if (selectedBg === 'none') {
                const colors = gradients[selectedImage];
                if (colors) {
                    const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                    gradient.addColorStop(0, colors[0]);
                    gradient.addColorStop(1, colors[1]);
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                }
            }
            
            // Draw placeholder text
            const characters = {
                'harvey1': '🤗 HARVEY 1 🤗',
                'harvey2': '😎 HARVEY 2 😎',
                'harvey3': '🥳 HARVEY 3 🥳',
                'harvey4': '🎭 HARVEY 4 🎭',
                'harvey5': '🌟 HARVEY 5 🌟',
                'harvey6': '🎨 HARVEY 6 🎨'
            };
            
            const isDarkBg = selectedBg === 'black';
            
            ctx.fillStyle = '#FF69B4';
            ctx.fillRect(50, 100, 300, 200);
            ctx.strokeStyle = isDarkBg ? '#FFF' : '#000';
            ctx.lineWidth = 3;
            ctx.strokeRect(50, 100, 300, 200);
            
            ctx.fillStyle = isDarkBg ? '#FFF' : '#000';
            ctx.font = 'bold 28px Comic Sans MS';
            ctx.textAlign = 'center';
            ctx.fillText(characters[selectedImage], 200, 200);
        }

        function drawTextElement(element, isSelected = false) {
            ctx.font = `bold ${element.size}px Comic Sans MS`;
            ctx.fillStyle = element.color;
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            ctx.textAlign = 'center';
            
            // Handle multi-line text
            const lines = element.text.split('\n');
            const lineHeight = element.size * 1.2;
            
            // Calculate text bounds for selection highlight
            let maxWidth = 0;
            lines.forEach(line => {
                const width = ctx.measureText(line).width;
                if (width > maxWidth) maxWidth = width;
            });
            const totalHeight = lines.length * lineHeight;
            
            // Draw selection highlight
            if (isSelected && !element.isPreview) {
                ctx.fillStyle = 'rgba(255, 182, 193, 0.3)';
                ctx.fillRect(
                    element.x - maxWidth/2 - 10,
                    element.y - element.size - 5,
                    maxWidth + 20,
                    totalHeight + 10
                );
                
                // Draw border
                ctx.strokeStyle = '#FF69B4';
                ctx.lineWidth = 2;
                ctx.strokeRect(
                    element.x - maxWidth/2 - 10,
                    element.y - element.size - 5,
                    maxWidth + 20,
                    totalHeight + 10
                );
            }
            
            // Reset styles for text
            ctx.fillStyle = element.color;
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            
            // Draw text
            lines.forEach((line, index) => {
                const y = element.y + (index * lineHeight);
                ctx.strokeText(line, element.x, y);
                ctx.fillText(line, element.x, y);
            });
        }

        function handleTextInput() {
            const text = document.getElementById('memeText').value;
            
            // If we're editing selected text, update it in real-time
            if (selectedTextIndex >= 0 && !isPreviewMode) {
                const size = parseInt(document.getElementById('textSize').value);
                const color = document.getElementById('textColor').value;
                
                textElements[selectedTextIndex].text = text;
                textElements[selectedTextIndex].size = size;
                textElements[selectedTextIndex].color = color;
                
                drawMemeBackground();
            } else {
                // Otherwise, use preview mode
                updateMemeText();
            }
        }

        function updateMemeText() {
            const text = document.getElementById('memeText').value;
            const size = parseInt(document.getElementById('textSize').value);
            const color = document.getElementById('textColor').value;
            
            // Update size display
            document.getElementById('sizeValue').textContent = size;
            
            // Real-time preview
            if (isPreviewMode) {
                // Clear previous preview and redraw everything
                drawMemeBackground();
                
                // Add preview text if there's content
                if (text.trim()) {
                    const previewText = {
                        text: text,
                        x: 200,
                        y: 50,
                        size: size,
                        color: color,
                        isPreview: true
                    };
                    drawTextElement(previewText);
                }
            }
        }

        function startDrag(e) {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Check if clicking on a text element (reverse order to get top element)
            for (let i = textElements.length - 1; i >= 0; i--) {
                const element = textElements[i];
                ctx.font = `bold ${element.size}px Comic Sans MS`;
                
                // Handle multi-line text bounds
                const lines = element.text.split('\n');
                const lineHeight = element.size * 1.2;
                const totalHeight = lines.length * lineHeight;
                let maxWidth = 0;
                
                lines.forEach(line => {
                    const width = ctx.measureText(line).width;
                    if (width > maxWidth) maxWidth = width;
                });
                
                if (x >= element.x - maxWidth/2 && x <= element.x + maxWidth/2 &&
                    y >= element.y - element.size && y <= element.y + totalHeight - element.size) {
                    
                    // Select this text element
                    selectText(i);
                    
                    // Start dragging
                    isDragging = true;
                    dragElement = element;
                    dragOffset.x = x - element.x;
                    dragOffset.y = y - element.y;
                    canvas.style.cursor = 'grabbing';
                    return;
                }
            }
            
            // If clicked on empty space, deselect
            selectText(-1);
        }

        function drag(e) {
            if (!isDragging || !dragElement) return;
            
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            dragElement.x = x - dragOffset.x;
            dragElement.y = y - dragOffset.y;
            
            // Keep text within canvas bounds
            dragElement.x = Math.max(20, Math.min(canvas.width - 20, dragElement.x));
            dragElement.y = Math.max(20, Math.min(canvas.height - 10, dragElement.y));
            
            drawMemeBackground();
        }

        function endDrag() {
            isDragging = false;
            dragElement = null;
            canvas.style.cursor = 'default';
        }

        function clearCanvas() {
            textElements = [];
            selectedTextIndex = -1;
            document.getElementById('memeText').value = '';
            isPreviewMode = true;
            drawMemeBackground();
        }

        function addText() {
            const text = document.getElementById('memeText').value.trim();
            const size = parseInt(document.getElementById('textSize').value);
            const color = document.getElementById('textColor').value;
            
            if (!text) {
                alert('💕 Please enter some text first!');
                return;
            }
            
            // If editing selected text, update it
            if (selectedTextIndex >= 0) {
                textElements[selectedTextIndex].text = text;
                textElements[selectedTextIndex].size = size;
                textElements[selectedTextIndex].color = color;
            } else {
                // Add new text element
                const newText = {
                    text: text,
                    x: 200,
                    y: 50 + textElements.length * 40, // Offset new text elements
                    size: size,
                    color: color
                };
                
                textElements.push(newText);
                // Select the newly added text
                selectedTextIndex = textElements.length - 1;
            }
            
            // Clear input and exit preview mode
            document.getElementById('memeText').value = '';
            isPreviewMode = false;
            
            // Redraw canvas
            drawMemeBackground();
        }

        function selectText(index) {
            selectedTextIndex = index;
            
            if (index >= 0) {
                // Load text into editor for in-place editing
                const element = textElements[index];
                document.getElementById('memeText').value = element.text;
                document.getElementById('textSize').value = element.size;
                document.getElementById('textColor').value = element.color;
                document.getElementById('sizeValue').textContent = element.size;
                
                // Exit preview mode when selecting existing text
                isPreviewMode = false;
            } else {
                // Clear editor when deselecting
                document.getElementById('memeText').value = '';
                isPreviewMode = true;
            }
            
            // Redraw to show selection
            drawMemeBackground();
        }

        function editText(index) {
            // This function is kept for compatibility but now just uses selectText
            selectText(index);
        }

        function updateEditText() {
            const size = parseInt(document.getElementById('editSize').value);
            document.getElementById('editSizeValue').textContent = size;
        }

        function saveEditText() {
            if (editingTextIndex >= 0) {
                const element = textElements[editingTextIndex];
                element.text = document.getElementById('editText').value;
                element.size = parseInt(document.getElementById('editSize').value);
                element.color = document.getElementById('editColor').value;
                
                drawMemeBackground();
                cancelEditText();
            }
        }

        function deleteEditText() {
            if (editingTextIndex >= 0) {
                textElements.splice(editingTextIndex, 1);
                drawMemeBackground();
                cancelEditText();
            }
        }

        function cancelEditText() {
            editingTextIndex = -1;
            document.getElementById('textEditModal').style.display = 'none';
        }

        function downloadMeme() {
            const canvas = document.getElementById('memeCanvas');
            const link = document.createElement('a');
            link.download = 'harvey-meme.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        // Social Sharing
        function shareToTwitter() {
            const text = "Just played Blood Money Game Online - No download needed! Experience the human expenditure program with Harvey and Eun-mi. #BloodMoneyGame #NoDownload #OnlineGame";
            const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        }

        function copyLink() {
            const dummy = document.createElement('input');
            document.body.appendChild(dummy);
            dummy.value = window.location.href;
            dummy.select();
            document.execCommand('copy');
            document.body.removeChild(dummy);
            alert('🌟 Link copied to clipboard! Yay! 🌟');
        }

        function shareToReddit() {
            const title = "Blood Money Game - Amazing Experience!";
            const url = `https://reddit.com/submit?url=${encodeURIComponent(window.location.href)}&title=${encodeURIComponent(title)}`;
            window.open(url, '_blank');
        }

        function shareToTikTok() {
            alert('🎵 To share on TikTok, create a cute video of your gameplay and use hashtags: #BloodMoneyGame #Harvey #Eunmi #Gaming 🎵');
        }

        function shareToDiscord() {
            const text = "Check out this amazing Blood Money Game! 🎮✨";
            if (navigator.share) {
                navigator.share({
                    title: 'Blood Money Game',
                    text: text,
                    url: window.location.href
                });
            } else {
                alert('Copy this link to share on Discord: ' + window.location.href);
            }
        }

        function shareToSocial(text) {
            if (navigator.share) {
                navigator.share({
                    title: 'Blood Money Game Achievement',
                    text: text,
                    url: window.location.href
                });
            } else {
                alert('Share this achievement: ' + text);
            }
        }

        // Ending Voting
        function voteEnding(ending) {
            if (hasVoted) {
                alert('🌟 You have already voted! Thank you for your participation. 🌟');
                return;
            }
            
            // Record the vote
            voteData[ending]++;
            hasVoted = true;
            showResults = true;
            
            // Update the display
            updateVotingResults();
            
            alert(`🌟 Thank you for voting for the ${ending} ending! Your vote has been recorded. You're awesome! 🌟`);
        }

        function updateVotingResults() {
            // Calculate total votes
            const totalVotes = voteData.good + voteData.normal + voteData.bad;
            
            // Update each progress bar
            updateProgressBar('good', voteData.good, totalVotes);
            updateProgressBar('normal', voteData.normal, totalVotes);
            updateProgressBar('bad', voteData.bad, totalVotes);
        }

        function updateProgressBar(type, votes, totalVotes) {
            const progressBar = document.getElementById(type + 'Progress');
            const percentage = totalVotes > 0 ? (votes / totalVotes) * 100 : 0;
            
            progressBar.style.width = percentage + '%';
            
            // Only show vote numbers after user has voted
            if (showResults) {
                if (votes === 0) {
                    progressBar.textContent = '0 votes';
                } else if (votes === 1) {
                    progressBar.textContent = '1 vote';
                } else {
                    progressBar.textContent = votes + ' votes';
                }
            } else {
                // Before voting, show empty content
                progressBar.textContent = '';
            }
        }

        // Comment System
        function postComment() {
            const name = document.getElementById('commentName').value;
            const text = document.getElementById('commentText').value;
            
            if (!name || !text) {
                alert('💕 Please enter both name and comment. We want to hear from you! 💕');
                return;
            }
            
            const commentsSection = document.getElementById('comments-section');
            const newComment = document.createElement('div');
            newComment.className = 'border-bottom pb-3 mb-3';
            newComment.innerHTML = `
                <div class="d-flex justify-content-between">
                    <strong>${name}</strong>
                    <small class="text-muted">Just now</small>
                </div>
                <p>${text}</p>
            `;
            
            commentsSection.appendChild(newComment);
            
            // Clear form
            document.getElementById('commentName').value = '';
            document.getElementById('commentText').value = '';
            
            alert('🌟 Comment posted successfully! Thank you for sharing! 🌟');
        }

        // Confetti Effect Function
        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3', '#54a0ff'];
            const confettiCount = 150;
            
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.style.position = 'fixed';
                confetti.style.width = Math.random() * 10 + 5 + 'px';
                confetti.style.height = Math.random() * 10 + 5 + 'px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = '-10px';
                confetti.style.opacity = Math.random() + 0.5;
                confetti.style.transform = 'rotate(' + Math.random() * 360 + 'deg)';
                confetti.style.pointerEvents = 'none';
                confetti.style.zIndex = '9999';
                
                document.body.appendChild(confetti);
                
                const animation = confetti.animate([
                    {
                        transform: 'translateY(-10px) rotate(0deg)',
                        opacity: 1
                    },
                    {
                        transform: 'translateY(' + (window.innerHeight + 20) + 'px) rotate(' + (Math.random() * 720 - 360) + 'deg)',
                        opacity: 0
                    }
                ], {
                    duration: Math.random() * 2000 + 2000,
                    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
                });
                
                animation.onfinish = () => {
                    confetti.remove();
                };
            }
        }

  
        // Close modal when clicking outside
        window.onclick = function(event) {
            const achievementModal = document.getElementById('achievementModal');
            const textEditModal = document.getElementById('textEditModal');
            
            if (event.target === achievementModal) {
                achievementModal.style.display = 'none';
            }
            
            if (event.target === textEditModal) {
                cancelEditText();
            }
        };

        // Initialize leaderboard when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateLeaderboard();
        });
    </script>
</body>
</html>
